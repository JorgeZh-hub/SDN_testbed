report: flows

inputs:
  extracted_root: "Prueba1_final/extracted"
  flows_glob: "rep_*/reports/flows/*.csv"
  flow_filter: [] # ejemplo: ["rtp_vc","rtp_voip"]
  group_by: ["flow", "protocol"]

# Agrupación "tipo protocolo" controlada 100% por YAML:
# - keys: el nombre del grupo (lo verás como id en summaries/plots cuando group="protocol")
# - flows: patrones (wildcards) sobre el nombre del CSV (stem), ej: "mqtt_*"
protocol_groups:
  rtp:
    flows: ["rtp_*", "voip_*"]
  mqtt:
    flows: ["mqtt_*"]
  coap:
    flows: ["coap_*"]
  amqp:
    flows: ["amqp_*"]
  # si algún flow no matchea, cae a protocol del CSV / inferencia por endpoints / "unknown"

units:
  delay: "ms"
  jitter: "ms"
  throughput: "Mbps"

filters:
  min_count_per_row: 1
  drop_rows_with_nan_mean: true

warmup:
  mode: "none" # none | fixed | auto
  fixed_seconds: 10
  auto:
    count_th: 1
    sustain_s: 3
    max_search_s: 120
  fallback_if_not_found: 0

loss:
  sent_basis: "count_a"
  include_negative_loss: false

throughput:
  normalization: "wall" # wall | active

timeseries:
  include_warmup: true
  min_reps_per_t: 1
  crop_to_common_time: true

jitter:
  auto_detect: true
  plot_only_if_present: true

stats:
  confidence:
    enable: true
    level: 0.95
    method: "t"

outputs:
  out_dir: "Prueba1_final/processed/flows"
  csv:
    rep_summary_flow: "rep_summary_flow.csv"
    rep_summary_protocol: "rep_summary_protocol.csv"
    load_summary_flow: "load_summary_flow.csv"
    load_summary_protocol: "load_summary_protocol.csv"
    ts_throughput_flow: "ts_throughput_flow.csv"
    ts_throughput_protocol: "ts_throughput_protocol.csv"
    missing: "missing_flows.csv"
  plots_dir: "Prueba1_final/processed/flows/plots"

plots:
  delay_vs_load:
    enable: true
    group: "flow" # flow | protocol
    metric: "delay_mean_ms"
    style:
      title: "Delay vs load - {id}"
      xlabel: "Carga"
      ylabel: "Delay (ms)"
      legend_title: "Controlador"

  jitter_vs_load:
    enable: true
    group: "flow"
    metric: "jitter_mean_ms"
    style:
      title: "Jitter vs load - {id}"
      xlabel: "Carga"
      ylabel: "Jitter (ms)"
      legend_title: "Controlador"

  loss_bars:
    enable: true
    group: "flow"
    metric: "loss_pct"
    style:
      title: "Pérdida vs load - {id}"
      xlabel: "Carga"
      ylabel: "Pérdida (%)"
      legend_title: "Controlador"

  throughput_bars:
    enable: true
    group: "flow"
    metric: "throughput_total_mean_Mbps"
    style:
      title: "Throughput promedio vs load - {id}"
      xlabel: "Carga"
      ylabel: "Throughput (Mbps)"
      legend_title: "Controlador"

  # Curvas 1 por controlador, para una carga seleccionada
  throughput_timeseries:
    enable: true
    group: "flow"
    select:
      load: "1.2a"
      id: "all" # o ["rtp_vc","mqtt_pubsub"]
      controller: "all" # o ["baseline","te"]
    style:
      title: "Throughput vs tiempo - load={load} - {id}"
      xlabel: "Tiempo (s)"
      ylabel: "Throughput (Mbps)"
      legend_title: "Controlador"

  # ✅ NUEVO: Curvas 1 por carga, para un (flow/protocol, controller) — o all
  throughput_timeseries_loads:
    enable: true
    group: "flow" # flow | protocol
    select:
      controller: "all" # o "baseline"
      id: "all" # o "rtp_vc"
      loads: "all" # o ["0.6a","1.2a","2a"]
    style:
      title: "Throughput vs tiempo - {id} - {controller}"
      xlabel: "Tiempo (s)"
      ylabel: "Throughput (Mbps)"
      legend_title: "Carga"
